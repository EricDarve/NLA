
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The LU Decomposition Algorithm &#8212; CME 302 Numerical Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/lu_decomposition';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Existence and Uniqueness of LU Factorization" href="existence_lu.html" />
    <link rel="prev" title="Solving Linear Systems" href="solving_linear_systems.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">CME 302 Numerical Linear Algebra</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Class Notes 2025
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="bootcamp.html">Linear Algebra Bootcamp</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="vector_space.html">Vector spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="dot_product_and_norms.html">Dot Product and Vector Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_transformations.html">Linear Transformations and Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_matrix_multiplication.html">Matrix-Matrix Multiplications</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator_norms.html">Operator and Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="sherman_morrison_woodbury.html">The Sherman-Morrison-Woodbury Formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="determinants.html">The Determinant</a></li>
<li class="toctree-l2"><a class="reference internal" href="trace.html">The Trace of a Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="orthogonal_matrices.html">Orthogonal Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="block_matrices.html">Block Matrix Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="four_fundamental_subspaces.html">The Four Fundamental Subspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigendecomposition.html">Eigendecomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="normal_matrices.html">Normal matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="applications_of_eigenvalues.html">Applications of Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="singular_value_decomposition.html">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigen_vs_singular_values.html">Eigenvalues and Singular Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary_of_matrix_decompositions.html">Summary of Matrix Decompositions</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="solving_linear_systems.html">Solving Linear Systems</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The LU Decomposition Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="existence_lu.html">Existence and Uniqueness of LU Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="floating_point.html">Floating-Point Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="lu_pivoting.html">LU Factorization with Row Pivoting</a></li>
<li class="toctree-l2"><a class="reference internal" href="cholesky.html">Cholesky Factorization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="least_squares.html">Least Squares Problems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="householder_reflections.html">Householder Reflections</a></li>
<li class="toctree-l2"><a class="reference internal" href="givens_rotations.html">Givens Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="modified_gram_schmidt.html">Modified Gram-Schmidt</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="existence_and_uniqueness_qr.html">Existence and Uniqueness of QR Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="backward_stability.html">Backward Stability of Householder and Givens QR</a></li>
<li class="toctree-l2"><a class="reference internal" href="qr_and_determinant.html">The QR Factorization and the Determinant</a></li>
<li class="toctree-l2"><a class="reference internal" href="lu_vs_qr.html">LU vs. QR Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="normal_equations.html">The Method of Normal Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="LS_using_QR.html">Solving Least-Squares using QR Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="LS_using_SVD.html">SVD for Rank-Deficient Least-Squares</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License for this book</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/lu_decomposition.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The LU Decomposition Algorithm</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-triangular-systems-the-building-block">Solving Triangular Systems: The Building Block</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-triangular-systems-forward-substitution">Lower Triangular Systems: Forward Substitution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-triangular-systems-backward-substitution">Upper Triangular Systems: Backward Substitution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-two-step-solution-process">The Two-Step Solution Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-views-of-matrix-multiplication">Two Views of Matrix Multiplication</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-concrete-example">A Concrete Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-this-view-important">Why is This View Important? 🤔</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-algorithm-via-outer-products">Deriving the Algorithm via Outer Products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-determining-l-1-and-u-1">Step 1: Determining <span class="math notranslate nohighlight">\(l_{:,1}\)</span> and <span class="math notranslate nohighlight">\(u_{1,:}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-the-rank-one-update">Step 2: The Rank-One Update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-general-algorithm">The General Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-algorithm-step-by-step">The Algorithm Step-by-Step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-place-lu-factorization-no-pivoting">In-Place LU Factorization (no pivoting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pivot-problem-when-things-go-wrong">The Pivot Problem: When Things Go Wrong 🚧</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-lu-decomposition-algorithm">
<h1>The LU Decomposition Algorithm<a class="headerlink" href="#the-lu-decomposition-algorithm" title="Link to this heading">#</a></h1>
<section id="solving-triangular-systems-the-building-block">
<h2>Solving Triangular Systems: The Building Block<a class="headerlink" href="#solving-triangular-systems-the-building-block" title="Link to this heading">#</a></h2>
<p>The strategy of solving <span class="math notranslate nohighlight">\(Ax = b\)</span> by factoring <span class="math notranslate nohighlight">\(A\)</span> into <span class="math notranslate nohighlight">\(LU\)</span> is only useful if solving the resulting triangular systems, <span class="math notranslate nohighlight">\(Ly = b\)</span> and <span class="math notranslate nohighlight">\(Ux = y\)</span>, is significantly easier than solving the original problem. Fortunately, it is. The unique structure of triangular matrices—with zeros on one side of the diagonal—allows us to solve for the unknown variables one by one in a straightforward process.</p>
<section id="lower-triangular-systems-forward-substitution">
<h3>Lower Triangular Systems: Forward Substitution<a class="headerlink" href="#lower-triangular-systems-forward-substitution" title="Link to this heading">#</a></h3>
<p>Consider a lower triangular system <span class="math notranslate nohighlight">\(Lx = b\)</span>. Let’s write it out for a small <span class="math notranslate nohighlight">\(3 \times 3\)</span> case to see the structure:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
l_{11} &amp; 0 &amp; 0 \\
l_{21} &amp; l_{22} &amp; 0 \\
l_{31} &amp; l_{32} &amp; l_{33}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
x_3
\end{pmatrix}
=
\begin{pmatrix}
b_1 \\
b_2 \\
b_3
\end{pmatrix}
\end{split}\]</div>
<p>Written as a system of equations, this is:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(l_{11}x_1 = b_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(l_{21}x_1 + l_{22}x_2 = b_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(l_{31}x_1 + l_{32}x_2 + l_{33}x_3 = b_3\)</span></p></li>
</ol>
<p>The solution process unfolds naturally:</p>
<ul class="simple">
<li><p>From the first equation, we can immediately solve for <span class="math notranslate nohighlight">\(x_1\)</span>, as it’s the only unknown: <span class="math notranslate nohighlight">\(x_1 = b_1 / l_{11}\)</span>.</p></li>
<li><p>Now that we know <span class="math notranslate nohighlight">\(x_1\)</span>, we can substitute it into the second equation, which now only has one unknown, <span class="math notranslate nohighlight">\(x_2\)</span>. We can solve for it: <span class="math notranslate nohighlight">\(x_2 = (b_2 - l_{21}x_1) / l_{22}\)</span>.</p></li>
<li><p>Finally, knowing <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>, we substitute them into the third equation to find <span class="math notranslate nohighlight">\(x_3\)</span>.</p></li>
</ul>
<p>This sequential process is called <strong>forward substitution</strong> because we solve for the variables in the forward order: <span class="math notranslate nohighlight">\(x_1, x_2, \dots, x_n\)</span>. The general formula for <span class="math notranslate nohighlight">\(x_i\)</span>, assuming we have already computed <span class="math notranslate nohighlight">\(x_1, \dots, x_{i-1}\)</span>, is:</p>
<div class="math notranslate nohighlight">
\[x_i = \frac{1}{l_{ii}} \Big( b_i - \sum_{j=1}^{i-1} l_{ij} x_j \Big)\]</div>
<p>This process is well-defined as long as all diagonal entries <span class="math notranslate nohighlight">\(l_{ii}\)</span> are non-zero, which is guaranteed if <span class="math notranslate nohighlight">\(L\)</span> is invertible.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">forward_substitution</span><span class="p">(</span><span class="n">L</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solves the lower triangular system Lx = b using forward substitution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">x</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="upper-triangular-systems-backward-substitution">
<h3>Upper Triangular Systems: Backward Substitution<a class="headerlink" href="#upper-triangular-systems-backward-substitution" title="Link to this heading">#</a></h3>
<p>The exact same logic applies to upper triangular systems of the form <span class="math notranslate nohighlight">\(Ux = b\)</span>, but the solution is found in the reverse order. Let’s look at the <span class="math notranslate nohighlight">\(3 \times 3\)</span> case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} \\
0 &amp; u_{22} &amp; u_{23} \\
0 &amp; 0 &amp; u_{33}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
x_3
\end{pmatrix}
=
\begin{pmatrix}
b_1 \\
b_2 \\
b_3
\end{pmatrix}
\end{split}\]</div>
<p>The system of equations is:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(u_{11}x_1 + u_{12}x_2 + u_{13}x_3 = b_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u_{22}x_2 + u_{23}x_3 = b_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u_{33}x_3 = b_3\)</span></p></li>
</ol>
<p>Here, we start from the bottom and work our way up:</p>
<ul class="simple">
<li><p>The last equation has only one unknown, <span class="math notranslate nohighlight">\(x_3\)</span>, which we can solve for immediately: <span class="math notranslate nohighlight">\(x_3 = b_3 / u_{33}\)</span>.</p></li>
<li><p>Knowing <span class="math notranslate nohighlight">\(x_3\)</span>, we can plug it into the second-to-last equation to solve for <span class="math notranslate nohighlight">\(x_2\)</span>.</p></li>
<li><p>And so on, until we find <span class="math notranslate nohighlight">\(x_1\)</span>.</p></li>
</ul>
<p>This process is called <strong>backward substitution</strong>. The general formula for computing <span class="math notranslate nohighlight">\(x_i\)</span>, assuming we have already found <span class="math notranslate nohighlight">\(x_{n}, x_{n-1}, \dots, x_{i+1}\)</span>, is:</p>
<div class="math notranslate nohighlight">
\[x_i = \frac{1}{u_{ii}} \left( b_i - \sum_{j=i+1}^{n} u_{ij} x_j \right)\]</div>
</section>
<section id="computational-cost">
<h3>Computational Cost 💰<a class="headerlink" href="#computational-cost" title="Link to this heading">#</a></h3>
<p>Let’s analyze the cost of forward substitution. To compute each <span class="math notranslate nohighlight">\(x_i\)</span>, the formula requires:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(i-1\)</span> multiplications (<span class="math notranslate nohighlight">\(l_{ij} x_j\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(i-1\)</span> subtractions</p></li>
<li><p><span class="math notranslate nohighlight">\(1\)</span> division</p></li>
</ul>
<p>In numerical linear algebra, we often count a fused multiplication and addition/subtraction as a single <strong>floating-point operation</strong>, or <strong>flop</strong>. Thus, computing <span class="math notranslate nohighlight">\(x_i\)</span> takes approximately <span class="math notranslate nohighlight">\(i-1\)</span> flops for the sum and one flop for the division, for a total of <span class="math notranslate nohighlight">\(i\)</span> flops. To find the total cost for solving the entire system, we sum this over all <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{Total Flops} = \sum_{i=1}^{n} (i-1) \approx \sum_{i=1}^{n} i = \frac{n(n+1)}{2} = \frac{1}{2}n^2 + O(n)\]</div>
<p><em>Note: A more precise count yields approximately <span class="math notranslate nohighlight">\(n^2\)</span> flops.</em></p>
<p>The cost for backward substitution is identical. The key takeaway is that solving a triangular system of size <span class="math notranslate nohighlight">\(n\)</span> costs approximately <span class="math notranslate nohighlight">\(n^2\)</span> floating-point operations. We say the complexity is <strong><span class="math notranslate nohighlight">\(O(n^2)\)</span></strong>.</p>
<p>This is remarkably efficient. As we will see, general methods for solving <span class="math notranslate nohighlight">\(Ax=b\)</span> (like the LU factorization itself) cost <span class="math notranslate nohighlight">\(O(n^3)\)</span> flops. For a large matrix, the difference between <span class="math notranslate nohighlight">\(n^2\)</span> and <span class="math notranslate nohighlight">\(n^3\)</span> is enormous. The cost of the two triangular solves is so low that it’s considered negligible compared to the cost of the initial factorization. This is what makes factorization-based methods so powerful.</p>
<p>Once you have the LU factorization of a matrix <span class="math notranslate nohighlight">\(A\)</span>, solving the linear system <span class="math notranslate nohighlight">\(Ax=b\)</span> becomes a straightforward and efficient two-step process involving only triangular solves.</p>
<p>This method transforms one difficult problem into two simple ones.</p>
</section>
</section>
<section id="the-two-step-solution-process">
<h2>The Two-Step Solution Process<a class="headerlink" href="#the-two-step-solution-process" title="Link to this heading">#</a></h2>
<p>The core idea is to substitute the factorization <span class="math notranslate nohighlight">\(A=LU\)</span> into the original equation and strategically group the terms.</p>
<ol class="arabic">
<li><p><strong>Start with the original system:</strong></p>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
</li>
<li><p><strong>Substitute the factorization:</strong></p>
<div class="math notranslate nohighlight">
\[(LU)x = b\]</div>
</li>
<li><p><strong>Group the terms.</strong> Using the associative property of matrix multiplication, we can write:</p>
<div class="math notranslate nohighlight">
\[L(Ux) = b\]</div>
</li>
<li><p><strong>Introduce an intermediate vector.</strong> Let’s define a temporary vector <span class="math notranslate nohighlight">\(z\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[z = Ux\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(z\)</span> into the equation from step 3 gives us our first problem:</p>
<div class="math notranslate nohighlight">
\[Lz = b\]</div>
</li>
</ol>
<p>This decouples the original system into two manageable triangular systems:</p>
<p><strong>Step 1: Solve for <span class="math notranslate nohighlight">\(z\)</span> using Forward Substitution</strong></p>
<p>First, we solve the lower triangular system <span class="math notranslate nohighlight">\(Lz = b\)</span> for the intermediate vector <span class="math notranslate nohighlight">\(z\)</span>. As we’ve seen, this is computationally inexpensive.</p>
<p><strong>Step 2: Solve for <span class="math notranslate nohighlight">\(x\)</span> using Backward Substitution</strong></p>
<p>Once we have computed <span class="math notranslate nohighlight">\(z\)</span>, we solve the upper triangular system <span class="math notranslate nohighlight">\(Ux = z\)</span> for our final solution vector <span class="math notranslate nohighlight">\(x\)</span>. This is also computationally inexpensive.</p>
<p>This two-stage process—forward substitution followed by backward substitution—is the standard method for solving a linear system once its LU factorization is known.</p>
<section id="id1">
<h3>Computational Cost 💰<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>The efficiency of this approach is its main advantage. Assuming the LU factorization is already available:</p>
<ul class="simple">
<li><p><strong>Cost of Step 1 (Forward Substitution):</strong> Solving <span class="math notranslate nohighlight">\(Lz=b\)</span> takes <strong><span class="math notranslate nohighlight">\(n^2\)</span></strong> flops.</p></li>
<li><p><strong>Cost of Step 2 (Backward Substitution):</strong> Solving <span class="math notranslate nohighlight">\(Ux=z\)</span> also takes <strong><span class="math notranslate nohighlight">\(n^2\)</span></strong> flops.</p></li>
</ul>
<p>The <strong>total computational cost</strong> to solve the system is the sum of these two steps: <span class="math notranslate nohighlight">\(n^2 + n^2 = \mathbf{2n^2}\)</span> flops. Therefore, the overall complexity is <span class="math notranslate nohighlight">\(O(n^2)\)</span>.</p>
<p>This provides the core motivation for LU factorization. While finding the factors <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> is an expensive <span class="math notranslate nohighlight">\(O(n^3)\)</span> operation, once you have them, you can solve for any right-hand side <span class="math notranslate nohighlight">\(b\)</span> very quickly. This is a massive advantage in applications where the same matrix <span class="math notranslate nohighlight">\(A\)</span> must be used with many different <span class="math notranslate nohighlight">\(b\)</span> vectors.</p>
</section>
</section>
<section id="two-views-of-matrix-multiplication">
<h2>Two Views of Matrix Multiplication<a class="headerlink" href="#two-views-of-matrix-multiplication" title="Link to this heading">#</a></h2>
<p>The product of two matrices can be viewed as a sum of <strong>outer products</strong>. This perspective is a powerful tool for developing and understanding matrix factorization algorithms.</p>
<p>Let’s consider the product of two <span class="math notranslate nohighlight">\(n \times n\)</span> matrices, <span class="math notranslate nohighlight">\(A = BC\)</span>.</p>
<p><strong>1. The Inner Product View (The Standard Method)</strong></p>
<p>You’re likely most familiar with the “inner product” or “dot product” view. To find the entry <span class="math notranslate nohighlight">\(a_{ij}\)</span>, you take the dot product of the <strong><span class="math notranslate nohighlight">\(i\)</span>-th row</strong> of <span class="math notranslate nohighlight">\(B\)</span> with the <strong><span class="math notranslate nohighlight">\(j\)</span>-th column</strong> of <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="math notranslate nohighlight">
\[a_{ij} = (\text{row } i \text{ of } B) \cdot (\text{column } j \text{ of } C) = \sum_{k=1}^n b_{ik}c_{kj}\]</div>
<p>Here, we compute the final matrix <span class="math notranslate nohighlight">\(A\)</span> one scalar entry at a time.</p>
<p><strong>2. The Outer Product View</strong></p>
<p>The outer product view reframes the entire calculation. Instead of a sum of scalars, we see the matrix <span class="math notranslate nohighlight">\(A\)</span> as a <strong>sum of matrices</strong>. Specifically, it’s the sum of the outer products of the columns of <span class="math notranslate nohighlight">\(B\)</span> with the corresponding rows of <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="math notranslate nohighlight">
\[A = \sum_{k=1}^n (\text{column } k \text{ of } B) (\text{row } k \text{ of } C) = \sum_{k=1}^n b_{:,k} c_{k,:}\]</div>
<p>Each term in this sum, <span class="math notranslate nohighlight">\(b_{:,k} c_{k,:}\)</span>, is an outer product between a column vector (size <span class="math notranslate nohighlight">\(n \times 1\)</span>) and a row vector (size <span class="math notranslate nohighlight">\(1 \times n\)</span>). The result of each outer product is a full <span class="math notranslate nohighlight">\(n \times n\)</span> matrix, often called a <strong>rank-one matrix</strong>. The final matrix <span class="math notranslate nohighlight">\(A\)</span> is constructed by adding these rank-one matrices together.</p>
<section id="a-concrete-example">
<h3>A Concrete Example<a class="headerlink" href="#a-concrete-example" title="Link to this heading">#</a></h3>
<p>Let’s see this in action for a simple <span class="math notranslate nohighlight">\(2 \times 2\)</span> case where <span class="math notranslate nohighlight">\(A = BC\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \underbrace{\begin{pmatrix} b_{11} \\ b_{21} \end{pmatrix}}_{b_{:,1}} \underbrace{\begin{pmatrix} c_{11} &amp; c_{12} \end{pmatrix}}_{c_{1,:}} + \underbrace{\begin{pmatrix} b_{12} \\ b_{22} \end{pmatrix}}_{b_{:,2}} \underbrace{\begin{pmatrix} c_{21} &amp; c_{22} \end{pmatrix}}_{c_{2,:}}\end{split}\]</div>
<p>First, compute the two rank-one matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} b_{11}c_{11} &amp; b_{11}c_{12} \\ b_{21}c_{11} &amp; b_{21}c_{12} \end{pmatrix} + \begin{pmatrix} b_{12}c_{21} &amp; b_{12}c_{22} \\ b_{22}c_{21} &amp; b_{22}c_{22} \end{pmatrix}\end{split}\]</div>
<p>Then, sum them to get the final result:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \begin{pmatrix} b_{11}c_{11} + b_{12}c_{21} &amp; b_{11}c_{12} + b_{12}c_{22} \\ b_{21}c_{11} + b_{22}c_{21} &amp; b_{21}c_{12} + b_{22}c_{22} \end{pmatrix}\end{split}\]</div>
<p>As you can see, each entry matches the result from the standard inner product definition.</p>
</section>
<section id="why-is-this-view-important">
<h3>Why is This View Important? 🤔<a class="headerlink" href="#why-is-this-view-important" title="Link to this heading">#</a></h3>
<p>While it might seem more complex, the outer product perspective is crucial for algorithm design. It shows us how a matrix can be built up iteratively. Many factorization algorithms, including LU, are based on the idea of “peeling off” or subtracting these rank-one components from the original matrix one at a time to reveal its underlying structure. We will use this exact idea to derive the LU factorization algorithm.</p>
</section>
</section>
<section id="deriving-the-algorithm-via-outer-products">
<h2>Deriving the Algorithm via Outer Products<a class="headerlink" href="#deriving-the-algorithm-via-outer-products" title="Link to this heading">#</a></h2>
<p>The LU factorization algorithm elegantly computes the factors <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> by systematically eliminating entries in the matrix <span class="math notranslate nohighlight">\(A\)</span>. The outer product perspective provides a clear way to understand this process as a sequence of <strong>rank-one updates</strong>.</p>
<p>The core idea is to build <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> iteratively. We start with the outer product formulation of the factorization:</p>
<div class="math notranslate nohighlight">
\[A = \sum_{k=1}^n l_{:,k} u_{k,:} = l_{:,1} u_{1,:} + l_{:,2} u_{2,:} + \dots + l_{:,n} u_{n,:}\]</div>
<p>This expresses the matrix <span class="math notranslate nohighlight">\(A\)</span> as a sum of rank-one matrices. Our goal is to determine one pair of vectors—a column of <span class="math notranslate nohighlight">\(L\)</span> and a row of <span class="math notranslate nohighlight">\(U\)</span>—at each step.</p>
<section id="step-1-determining-l-1-and-u-1">
<h3>Step 1: Determining <span class="math notranslate nohighlight">\(l_{:,1}\)</span> and <span class="math notranslate nohighlight">\(u_{1,:}\)</span><a class="headerlink" href="#step-1-determining-l-1-and-u-1" title="Link to this heading">#</a></h3>
<p>Let’s isolate the first term (<span class="math notranslate nohighlight">\(k=1\)</span>). Due to the triangular structures of <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>:</p>
<ul class="simple">
<li><p>The first column of <span class="math notranslate nohighlight">\(U\)</span> is <span class="math notranslate nohighlight">\((u_{11}, 0, \dots, 0)^T\)</span>.</p></li>
<li><p>The first row of <span class="math notranslate nohighlight">\(L\)</span> is <span class="math notranslate nohighlight">\((l_{11}, 0, \dots, 0)\)</span>.</p></li>
</ul>
<p>This structure simplifies the first column and first row of the product <span class="math notranslate nohighlight">\(LU\)</span>:</p>
<ul class="simple">
<li><p><strong>First Column:</strong> <span class="math notranslate nohighlight">\(a_{:,1} = (LU)_{:,1} = L u_{:,1} = l_{:,1}u_{11}\)</span>.</p></li>
<li><p><strong>First Row:</strong> <span class="math notranslate nohighlight">\(a_{1,:} = (LU)_{1,:} = l_{1,:} U = l_{11}u_{1,:}\)</span>.</p></li>
</ul>
<p>We now have two equations, but more unknowns than constraints. To get a unique solution, we must impose a condition. The standard convention is to require the diagonal entries of <span class="math notranslate nohighlight">\(L\)</span> to be 1. This is known as a <strong>Doolittle factorization</strong>.</p>
<p>Setting <span class="math notranslate nohighlight">\(l_{11} = 1\)</span>:</p>
<ol class="arabic">
<li><p>From <span class="math notranslate nohighlight">\(a_{1,:} = l_{11}u_{1,:} = 1 \cdot u_{1,:}\)</span>, we immediately get the first row of <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="math notranslate nohighlight">
\[u_{1,:} = a_{1,:}\]</div>
</li>
<li><p>From <span class="math notranslate nohighlight">\(u_{1,:}\)</span>, we know that its first element is <span class="math notranslate nohighlight">\(u_{11} = a_{11}\)</span>. Substituting this into the column equation <span class="math notranslate nohighlight">\(a_{:,1} = l_{:,1} u_{11}\)</span>, we can solve for the first column of <span class="math notranslate nohighlight">\(L\)</span>:</p>
<div class="math notranslate nohighlight">
\[l_{:,1} = \frac{a_{:,1}}{u_{11}} = \frac{a_{:,1}}{a_{11}}\]</div>
</li>
</ol>
<p>This step completely determines the first column of <span class="math notranslate nohighlight">\(L\)</span> and the first row of <span class="math notranslate nohighlight">\(U\)</span>. This is only possible if our pivot element <span class="math notranslate nohighlight">\(a_{11} \neq 0\)</span>, an assumption we will revisit later.</p>
</section>
<section id="step-2-the-rank-one-update">
<h3>Step 2: The Rank-One Update<a class="headerlink" href="#step-2-the-rank-one-update" title="Link to this heading">#</a></h3>
<p>We have now successfully “peeled off” the first term of the outer product sum. We can define an updated matrix, <span class="math notranslate nohighlight">\(A^{(1)}\)</span>, which represents the remainder of the sum:</p>
<div class="math notranslate nohighlight">
\[A^{(1)} = A - l_{:,1} u_{1,:} = \sum_{k=2}^n l_{:,k} u_{k,:}\]</div>
<p>By construction, the first row and first column of the matrix <span class="math notranslate nohighlight">\(l_{:,1}u_{1,:}\)</span> are identical to the first row and column of <span class="math notranslate nohighlight">\(A\)</span>. Therefore, the first row and column of <span class="math notranslate nohighlight">\(A^{(1)}\)</span> are zero.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^{(1)} = 
\begin{pmatrix}
0 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; &amp; &amp; \\
\vdots &amp; &amp; A' &amp; \\
0 &amp; &amp; &amp; 
\end{pmatrix}
\end{split}\]</div>
<p>The problem now reduces to finding the LU factorization of the smaller <span class="math notranslate nohighlight">\((n-1) \times (n-1)\)</span> submatrix <span class="math notranslate nohighlight">\(A'\)</span> in the lower-right corner.</p>
</section>
<section id="the-general-algorithm">
<h3>The General Algorithm<a class="headerlink" href="#the-general-algorithm" title="Link to this heading">#</a></h3>
<p>We can repeat this process iteratively. At each step <span class="math notranslate nohighlight">\(k\)</span> (from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span>), we:</p>
<ol class="arabic simple">
<li><p><strong>Identify</strong> the <span class="math notranslate nohighlight">\(k\)</span>-th column of <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(k\)</span>-th row of <span class="math notranslate nohighlight">\(U\)</span> using the current updated matrix <span class="math notranslate nohighlight">\(A^{(k-1)}\)</span>.</p></li>
<li><p><strong>Perform</strong> a rank-one update to compute the next matrix: <span class="math notranslate nohighlight">\(A^{(k)} = A^{(k-1)} - l_{:,k} u_{k,:}\)</span>.</p></li>
</ol>
<p>This process continues until all columns of <span class="math notranslate nohighlight">\(L\)</span> and rows of <span class="math notranslate nohighlight">\(U\)</span> have been determined.</p>
</section>
<section id="id2">
<h3>Computational Cost 💰<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Let’s analyze the cost. At each step <span class="math notranslate nohighlight">\(k\)</span>, the main work is the rank-one update of the lower-right submatrix of size <span class="math notranslate nohighlight">\((n-k) \times (n-k)\)</span>. This update requires approximately <span class="math notranslate nohighlight">\(2(n-k)^2\)</span> floating-point operations.</p>
<p>To find the total cost, we sum this over all steps:</p>
<div class="math notranslate nohighlight">
\[\text{Total Flops} \approx \sum_{k=1}^{n-1} 2(n-k)^2 = 2 \sum_{j=1}^{n-1} j^2 \approx 2 \frac{(n-1)^3}{3} \approx \frac{2}{3}n^3\]</div>
<p>The computational cost of computing the LU factorization is <strong><span class="math notranslate nohighlight">\(O(n^3)\)</span></strong>. This is significantly more expensive than the <span class="math notranslate nohighlight">\(O(n^2)\)</span> triangular solves that follow, which is why we separate the factorization and solving stages.</p>
</section>
</section>
<section id="the-algorithm-step-by-step">
<h2>The Algorithm Step-by-Step<a class="headerlink" href="#the-algorithm-step-by-step" title="Link to this heading">#</a></h2>
<p>The algorithm constructs the columns of <span class="math notranslate nohighlight">\(L\)</span> and the rows of <span class="math notranslate nohighlight">\(U\)</span> iteratively, from <span class="math notranslate nohighlight">\(k=1\)</span> to <span class="math notranslate nohighlight">\(n\)</span>. Let’s walk through the process for a general step <span class="math notranslate nohighlight">\(k\)</span>, assuming the first <span class="math notranslate nohighlight">\(k-1\)</span> steps are complete. At this point, the first <span class="math notranslate nohighlight">\(k-1\)</span> columns of <span class="math notranslate nohighlight">\(L\)</span> and rows of <span class="math notranslate nohighlight">\(U\)</span> are finalized.</p>
<ol class="arabic">
<li><p><strong>Determine Row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(U\)</span></strong>: The <span class="math notranslate nohighlight">\(k\)</span>-th row of <span class="math notranslate nohighlight">\(U\)</span> is simply the <span class="math notranslate nohighlight">\(k\)</span>-th row of the <em>current</em>, modified matrix <span class="math notranslate nohighlight">\(A\)</span>. The elements <span class="math notranslate nohighlight">\(u_{kj}\)</span> for <span class="math notranslate nohighlight">\(j &lt; k\)</span> are zero because <span class="math notranslate nohighlight">\(U\)</span> is upper triangular.</p>
<div class="math notranslate nohighlight">
\[u_{k, k:n} = a_{k, k:n}\]</div>
</li>
<li><p><strong>Determine Column <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(L\)</span></strong>: The <span class="math notranslate nohighlight">\(k\)</span>-th column of <span class="math notranslate nohighlight">\(L\)</span> is found by taking the <span class="math notranslate nohighlight">\(k\)</span>-th column of the current matrix <span class="math notranslate nohighlight">\(A\)</span> and scaling it by the diagonal element <span class="math notranslate nohighlight">\(a_{kk}\)</span>, which we call the <strong>pivot</strong>. By convention, we set <span class="math notranslate nohighlight">\(l_{kk}=1\)</span>.</p>
<div class="math notranslate nohighlight">
\[l_{k:n, k} = \frac{a_{k:n, k}}{a_{kk}}\]</div>
</li>
<li><p><strong>Update the Submatrix (Schur Complement)</strong>: This is the core of the algorithm. We form the outer product of the just-computed vectors (<span class="math notranslate nohighlight">\(l_{:,k}\)</span> and <span class="math notranslate nohighlight">\(u_{k,:}\)</span>) and subtract it from the matrix <span class="math notranslate nohighlight">\(A\)</span>. This update effectively zeroes out the <span class="math notranslate nohighlight">\(k\)</span>-th row and column’s influence on the rest of the matrix, leaving a smaller problem to solve in the next iteration.</p>
<div class="math notranslate nohighlight">
\[A \leftarrow A - l_{:,k} u_{k,:}\]</div>
<p>Specifically, this update only affects the submatrix to the lower right of the pivot, from row and column <span class="math notranslate nohighlight">\(k+1\)</span> to <span class="math notranslate nohighlight">\(n\)</span>.</p>
</li>
</ol>
<p>This loop continues until all columns of <span class="math notranslate nohighlight">\(L\)</span> and rows of <span class="math notranslate nohighlight">\(U\)</span> are determined. In a typical implementation, the computed values for <span class="math notranslate nohighlight">\(L\)</span> (below the diagonal) and <span class="math notranslate nohighlight">\(U\)</span> (on and above the diagonal) are stored directly in the matrix <span class="math notranslate nohighlight">\(A\)</span> to save space.</p>
<section id="in-place-lu-factorization-no-pivoting">
<h3>In-Place LU Factorization (no pivoting)<a class="headerlink" href="#in-place-lu-factorization-no-pivoting" title="Link to this heading">#</a></h3>
<p>The factors are stored in A: the strict lower triangle holds L (with unit diagonal), and the upper triangle holds U.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lu_inplace</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs in-place LU factorization (Doolittle, no pivoting) and overwrites the input matrix A.</span>
<span class="sd">    On exit:</span>
<span class="sd">      - L is in the strict lower triangle with implicit unit diagonal</span>
<span class="sd">      - U is in the upper triangle (including diagonal)</span>
<span class="sd">    Assumes:</span>
<span class="sd">      - All pivots are nonzero</span>
<span class="sd">      - No pivoting is performed (numerically unstable for some matrices)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Update the k-th column of L</span>
        <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="c1"># Rank-one update of the trailing submatrix</span>
        <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="the-pivot-problem-when-things-go-wrong">
<h3>The Pivot Problem: When Things Go Wrong 🚧<a class="headerlink" href="#the-pivot-problem-when-things-go-wrong" title="Link to this heading">#</a></h3>
<p>The algorithm has a critical weak point: the division by the pivot element <span class="math notranslate nohighlight">\(a_{kk}\)</span> in step 2.</p>
<p>The algorithm <strong>fails</strong> if at any step <span class="math notranslate nohighlight">\(k\)</span>, the pivot element <span class="math notranslate nohighlight">\(a_{kk}\)</span> of the <em>current</em> matrix is zero. This would require division by zero, bringing the entire process to a halt.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="solving_linear_systems.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Solving Linear Systems</p>
      </div>
    </a>
    <a class="right-next"
       href="existence_lu.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Existence and Uniqueness of LU Factorization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-triangular-systems-the-building-block">Solving Triangular Systems: The Building Block</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-triangular-systems-forward-substitution">Lower Triangular Systems: Forward Substitution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-triangular-systems-backward-substitution">Upper Triangular Systems: Backward Substitution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-two-step-solution-process">The Two-Step Solution Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-views-of-matrix-multiplication">Two Views of Matrix Multiplication</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-concrete-example">A Concrete Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-this-view-important">Why is This View Important? 🤔</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-algorithm-via-outer-products">Deriving the Algorithm via Outer Products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-determining-l-1-and-u-1">Step 1: Determining <span class="math notranslate nohighlight">\(l_{:,1}\)</span> and <span class="math notranslate nohighlight">\(u_{1,:}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-the-rank-one-update">Step 2: The Rank-One Update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-general-algorithm">The General Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Computational Cost 💰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-algorithm-step-by-step">The Algorithm Step-by-Step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-place-lu-factorization-no-pivoting">In-Place LU Factorization (no pivoting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pivot-problem-when-things-go-wrong">The Pivot Problem: When Things Go Wrong 🚧</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eric Darve
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>